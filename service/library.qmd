# Онлайн библиотека

## Overall Description

Проект представляет собой веб-сервис, который обеспечивает централизованное управление библиотечными процессами, заменяя традиционные бумажные системы. Ключевые возможности включают онлайн-каталог, управление пользователями, систему бронирования книг и автоматическое управление сроками аренды.

## Product Functions

-   Регистрация и аутентификация пользователей с системой ролей (Пользователь, Библиотекарь, Администратор).
-   Управление профилем пользователя.
-   Управление каталогом книг (добавление, редактирование, удаление).
-   Расширенный поиск и фильтрация книг.
-   Система бронирования и аренды книг.
-   Управление учётом (учет доступных и арендованных экземпляров).
-   Просмотр истории аренды и текущих заказов.

## System Features

### Управление каталогом книг

#### Description and Priority

Функция позволяет Библиотекарям и Администраторам управлять каталогом книг: добавлять, редактировать, удалять и архивировать книги. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Добавление новой книги**
    *   *Стимул:* Библиотекарь переходит в раздел "Управление каталогом", нажимает "Добавить книгу", заполняет информацию (название, автор, описание, ISBN, жанр, количество экземпляров) и сохраняет.
    *   *Ответ:* Система валидирует данные (например, уникальность ISBN), создает новую запись о книге в БД, создает указанное количество экземпляров (inventory items) и отображает новую книгу в каталоге.
-   **Сценарий 2: Поиск книги пользователем**
    *   *Стимул:* Пользователь на главной странице вводит в строку поиска название книги и нажимает "Найти".
    *   *Ответ:* Система выполняет поиск по названию и автору, отображает список подходящих книг с указанием их доступности.

#### Functional Requirements

-   **CAT-1**: Система должна позволять Библиотекарю/Администратору добавлять новые книги в каталог.
-   **CAT-2**: Система должна позволять редактировать информацию о существующей книге.
-   **CAT-3**: Система должна позволять помечать книгу как удаленную (soft delete), вместо физического удаления.
-   **CAT-4**: Система должна предоставлять интерфейс для поиска книг по названию, автору, ISBN и жанру.
-   **CAT-5**: Система должна отображать для каждой книги общее количество экземпляров и количество доступных для аренды.
-   **CAT-6**: Для каждой книги должна храниться следующая информация: UUID, название, автор(ы), описание, ISBN, жанр, дата добавления.

### Система бронирования и аренды

#### Description and Priority

Функция позволяет пользователям бронировать доступные книги на определенный срок. Система автоматически управляет состоянием экземпляров книг и сроками аренды. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Успешное бронирование книги**
    *   *Стимул:* Аутентифицированный пользователь на странице книги нажимает кнопку "Забронировать".
    *   *Ответ:* Система проверяет наличие доступных экземпляров, создает запись о брони (Rental) со статусом "ACTIVE", связывает ее с пользователем и конкретным экземпляром книги, уменьшает счетчик доступных экземпляров и устанавливает срок сдачи (например, +14 дней).
-   **Сценарий 2: Возврат книги**
    *   *Стимул:* Библиотекарь в панели управления находит активную аренду и нажимает "Вернуть книгу".
    *   *Ответ:* Система меняет статус аренды на "RETURNED", освобождает экземпляр книги (делает его доступным) и увеличивает счетчик доступных экземпляров.
-   **Сценарий 3: Попытка бронирования недоступной книги**
    *   *Стимул:* Пользователь нажимает "Забронировать" у книги с нулевым количеством доступных экземпляров.
    *   *Ответ:* Система отображает сообщение "В данный момент нет доступных экземпляров" и предлагает добавить книгу в "Лист ожидания".

#### Functional Requirements

-   **RENT-1**: Аутентифицированный пользователь должен иметь возможность забронировать доступную книгу.
-   **RENT-2**: Система должна автоматически назначать срок аренды (например, 14 дней) при бронировании.
-   **RENT-3**: Система должна запрещать пользователю брать более N книг одновременно (например, не более 5).
-   **RENT-4**: Система должна отслеживать просроченные аренды и менять их статус на "OVERDUE".
-   **RENT-5**: Библиотекарь должен иметь возможность подтвердить возврат книги, изменив статус аренды.
-   **RENT-6**: Пользователь должен иметь возможность просматривать историю своих аренд и текущие активные брони.

### Управление учётом

#### Description and Priority

Функция позволяет системе отслеживать отдельные физические/цифровые экземпляры книг. Каждая книга в каталоге связана с одним или несколькими экземплярами, каждый из которых имеет уникальный идентификатор и статус (доступен, арендован, на обслуживании). Приоритет: Средний.

#### Stimulus/Response Sequences

-   **Сценарий 1: Добавление новых экземпляров существующей книги**
    *   *Стимул:* Библиотекарь на странице редактирования книги изменяет количество экземпляров с 3 до 5.
    *   *Ответ:* Система создает 2 новых экземпляра этой книги в базе данных со статусом "AVAILABLE".
-   **Сценарий 2: Списание экземпляра**
    *   *Стимул:* Библиотекарь отмечает, что экземпляр книги утерян или поврежден, и меняет его статус на "SPOILED".
    *   *Ответ:* Система изменяет статус экземпляра, и он больше не учитывается как доступный для бронирования.

#### Functional Requirements

-   **INV-1**: Система должна поддерживать сущность "Экземпляр Книги" (Book Item), связанную с сущностью "Книга" (Book).
-   **INV-2**: Каждый экземпляр должен иметь уникальный идентификатор (UUID) и статус (AVAILABLE, RENTED, SPOILED).
-   **INV-3**: При бронировании система должна находить экземпляр со статусом AVAILABLE и менять его статус на RENTED.
-   **INV-4**: При возврате книги система должна менять статус экземпляра на AVAILABLE.

### Поиск и фильтрация

#### Description and Priority

Функция предоставляет пользователям мощный и удобный инструмент для поиска книг в каталоге по различным критериям. Приоритет: Высокий.

#### Stimulus/Response Sequences

**Сценарий: Расширенный поиск**
-   *Стимул:* Пользователь нажимает "Расширенный поиск", заполняет поля: Жанр = "Фантастика", Год издания > 2000, Доступность = "Только в наличии".
-   *Ответ:* Система выполняет запрос к БД, применяя все фильтры, и отображает релевантный список книг.

#### Functional Requirements

-   **SRCH-1**: Система должна предоставлять интерфейс для полнотекстового поиска по названию и автору.
-   **SRCH-2**: Система должна позволять фильтровать книги по жанру, году издания, языку.
-   **SRCH-3**: Система должна предоставлять фильтр "Показать только доступные книги".
-   **SRCH-4**: Результаты поиска должны быть разбиты на страницы (пагинация).
