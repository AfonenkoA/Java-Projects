# Веб серивис облачное хранилище

## Overall Description

Проект представляет собой безопасное, масштабируемое веб-приложение, которое позволяет пользователям хранить, управлять, обмениваться и просматривать свои файлы и фотографии через веб-браузер. Основное отличие от простого файлового хостинга — акцент на организации фотографий и гибких настройках доступа.

#### Product Functions

-   Регистрация и аутентификация пользователей.
-   Загрузка, скачивание и удаление файлов.
-   Организация файлов в папки.
-   Специфичные функции для фотографий: предпросмотр, базовые метаданные (EXIF).
-   Управление квотами на дисковое пространство.
-   Предоставление общего доступа к файлам и папкам через ссылки.
-   Поиск и фильтрация файлов.

## System Features

### Управление файловым пространством

#### Description and Priority

Позволяет аутентифицированному пользователю загружать файлы в свое хранилище, скачивать их и удалять. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Успешная загрузка файла**
    *   *Стимул:* Пользователь через веб-интерфейс перетаскивает файл в область загрузки.
    *   *Ответ:* Система проверяет квоту пользователя, сохраняет файл в файловую систему (или объектное хранилище), записывает метаданные (имя, размер, MIME-type, владелец, путь) в БД и обновляет занятое пространство пользователя.
-   **Сценарий 2: Скачивание файла**
    *   *Стимул:* Пользователь нажимает на кнопку "Скачать" у файла в интерфейсе.
    *   *Ответ:* Система проверяет права доступа, находит файл в хранилище и передает его клиенту как `application/octet-stream` (или конкретный MIME-type).
-   **Сценарий 3: Удаление файла**
    *   *Стимул:* Пользователь нажимает "Удалить" и подтверждает действие.
    *   *Ответ:* Система помечает запись в БД как удаленную (soft delete) и/или физически удаляет файл из хранилища, уменьшая занятое пространство пользователя.

#### Functional Requirements

*   **FILE-1**: Система должна предоставлять возможность для загрузки файлов (multipart/form-data).
*   **FILE-2**: Система должна проверять, что размер загружаемого файла не превышает лимит, установленный для одного файла, и не нарушает общую квоту пользователя.
*   **FILE-3**: Система должна предоставлять возможность для скачивания файла по его уникальному идентификатору.
*   **FILE-4**: Система должна предотвращать скачивание файла пользователем, не имеющим на него прав.
*   **FILE-5**: Система должна предоставлять возможность для удаления файла.

### Организация файлов в папки

#### Description and Priority

Позволяет пользователю создавать, переименовывать, удалять папки и перемещать файлы между ними для организации структуры хранения. Приоритет: Высокий.

#### Stimulus/Response Sequences

**Сценарий: Создание новой папки**

-   *Стимул:* Пользователь нажимает кнопку "Новая папка", вводит имя и выбирает родительскую папку.
-   *Ответ:* Система создает новую запись "папка" в БД, связывая ее с пользователем и родительской папкой.

#### Functional Requirements

-   **FOLDER-1**: Система должна позволять пользователю создавать вложенные папки.
-   **FOLDER-2**: Система должна запрещать создание двух папок с одинаковым именем на одном уровне вложенности у одного пользователя.
-   **FOLDER-3**: Система должна предоставлять API для получения древовидной структуры папок пользователя.
-   **FOLDER-4**: При удалении папки система должна удалить (или переместить в "корзину") все файлы и вложенные папки внутри нее.

### Функции для работы с фотографиями

#### Description and Priority

Предоставляет пользователю расширенный функционал для работы с изображениями, включая предпросмотр и извлечение метаданных. Приоритет: Средний.

#### Stimulus/Response Sequences

**Сценарий: Просмотр галереи фотографий**

-   *Стимул:* Пользователь переходит в раздел "Фотографии".
-   *Ответ:* Система отображает все загруженные пользователем файлы с MIME-type `image/*` в виде сетки превью. Превью генерируются автоматически при загрузке.

#### Functional Requirements

-   **PHOTO-1**: Система должна автоматически генерировать превью (thumbnail) для загружаемых изображений.
-   **PHOTO-2**: Система должна извлекать и сохранять в БД базовые EXIF-метаданные (дата съемки, модель камеры, геолокация).
-   **PHOTO-3**: Система должна предоставлять API для получения всех фотографий пользователя, отсортированных по дате съемки.

### Управление общим доступом

#### Description and Priority

Позволяет пользователю предоставлять доступ к своим файлам или папкам другим пользователям системы или гостям через публичные ссылки. Приоритет: Средний.

#### Stimulus/Response Sequences

**Сценарий: Создание публичной ссылки на файл**

-   *Стимул:* Пользователь выбирает файл, нажимает "Поделиться", выбирает "Создать ссылку".
-   *Ответ:* Система генерирует уникальный URL, сохраняет его в БД в связке с файлом и правами доступа (только просмотр / скачивание). Пользователю отображается созданная ссылка.

#### Functional Requirements

-   **SHARE-1**: Система должна позволять создавать публичные ссылки с ограниченным сроком действия.
-   **SHARE-2**: Система должна позволять предоставлять прямой доступ другим пользователям системы (по логину/email) с возможностью установки прав (чтение, запись).
-   **SHARE-3**: Доступ по публичной ссылке не должен требовать аутентификации в системе.

### Управление дисковым пространством

#### Description and Priority

Система контролирует объем дискового пространства, который использует каждый пользователь, и запрещает операции, ведущие к превышению лимита. Приоритет: Высокий.

#### Stimulus/Response Sequences

**Сценарий: Попытка загрузки файла, превышающего квоту**

-   *Стимул:* Пользователь пытается загрузить файл, размер которого превышает оставшееся свободное место.
-   *Ответ:* Система отклоняет запрос на загрузку и возвращает сообщение об ошибке "Недостаточно дискового пространства".

#### Functional Requirements

-   **QUOTA-1**: Система должна рассчитывать и хранить в БД общий объем файлов каждого пользователя.
-   **QUOTA-2**: Администратор должен иметь возможность устанавливать и изменять квоту для каждого пользователя.
-   **QUOTA-3**: Система должна блокировать операцию загрузки файла, если она приводит к превышению квоты пользователя.

### Поиск и фильтрация файлов

#### Description and Priority

Позволяет пользователю быстро находить файлы и папки по имени, типу или другим атрибутам. Приоритет: Низкий.

#### Stimulus/Response Sequences

**Сценарий: Поиск файла по имени**

-   *Стимул:* Пользователь вводит имя файла в строку поиска.
-   *Ответ:* Система возвращает список файлов и папок, чье имя соответствует запросу (с учетом регистра или без).

#### Functional Requirements

-   **SRCH-1**: Система должна предоставлять функции для поиска файлов по имени (LIKE-запрос).
-   **SRCH-2**: Система должна позволять фильтровать результаты по типу файла (например, "Изображения", "Документы").
