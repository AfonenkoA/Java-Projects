# Сервис онлайн опросов

## Overall Description

Реализовать веб-сервис для создания, проведения и анализа онлайн-опросов. Сервис должен предоставлять функциональность для администраторов, создающих опросы, и пользователей, участвующих в опросах.

## Product Functions

- Регистрация и аутентификация пользователей и администраторов
- Управление профилем пользователя
- Создание, редактирование и удаление опросов
- Прохождение опросов пользователями
- Просмотр результатов опросов в реальном времени
- Управление правами доступа к опросам
- Генерация отчетов по результатам опросов
- Система тегов и категорий для опросов
- Комментирование опросов

## System Features

### Управление опросами

#### Description and Priority

Функция позволяет администраторам создавать, редактировать и удалять опросы. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание нового опроса
    * *Стимул:* Администратор нажимает "Создать опрос", заполняет заголовок, описание, добавляет вопросы с вариантами ответов.
    * *Ответ:* Система сохраняет опрос в БД, генерирует уникальную ссылку для доступа.
- **Сценарий 2:** Редактирование существующего опроса
    * *Стимул:* Администратор выбирает опрос из списка, нажимает "Редактировать", изменяет вопросы или настройки.
    * *Ответ:* Система проверяет права доступа и обновляет опрос в БД.
- **Сценарий 3:** Удаление опроса
    * *Стимул:* Администратор выбирает опрос и нажимает "Удалить", подтверждает действие.
    * *Ответ:* Система помечает опрос как удаленный в БД.

#### Functional Requirements

- **SUR-1**: Система должна предоставлять функции для создания опросов
- **SUR-2**: Система должна поддерживать различные типы вопросов (один выбор, множественный выбор, текстовый ответ)
- **SUR-3**: Система должна генерировать уникальные ссылки для каждого опроса
- **SUR-4**: Система должна проверять права доступа при редактировании опросов
- **SUR-5**: Система должна поддерживать настройки видимости опроса (публичный, приватный, по ссылке)
- **SUR-6**: Система должна обеспечивать целостность данных при удалении опросов

### Прохождение опросов

#### Description and Priority

Функция позволяет пользователям проходить доступные опросы и отправлять ответы. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Прохождение публичного опроса
    * *Стимул:* Пользователь переходит по ссылке на опрос, отвечает на вопросы и нажимает "Отправить".
    * *Ответ:* Система сохраняет ответы, показывает благодарность и статистику (если доступно).
- **Сценарий 2:** Прохождение аутентифицированным пользователем
    * *Стимул:* Аутентифицированный пользователь выбирает опрос из списка доступных, отвечает на вопросы.
    * *Ответ:* Система сохраняет ответы с привязкой к пользователю, обновляет статистику в реальном времени.
- **Сценарий 3:** Попытка повторного прохождения
    * *Стимул:* Пользователь пытается повторно пройти опрос с настройкой "один ответ".
    * *Ответ:* Система проверяет историю и показывает сообщение о невозможности повторного участия.

#### Functional Requirements

- **TAK-1**: Система должна предоставлять функции для получения информации об опросе
- **TAK-2**: Система должна валидировать ответы перед сохранением
- **TAK-3**: Система должна предотвращать множественные ответы при соответствующих настройках
- **TAK-4**: Система должна сохранять ответы анонимных пользователей
- **TAK-5**: Система должна обновлять статистику ответов в реальном времени
- **TAK-6**: Система должна обрабатывать частично заполненные опросы

### Просмотр и анализ результатов

#### Description and Priority

Функция позволяет администраторам и пользователям просматривать результаты опросов в различных форматах. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Просмотр статистики опроса
    * *Стимул:* Администратор открывает страницу результатов опроса.
    * *Ответ:* Система отображает графики, диаграммы и таблицы с результатами.
- **Сценарий 2:** Экспорт результатов
    * *Стимул:* Администратор нажимает "Экспорт в CSV", выбирает параметры экспорта.
    * *Ответ:* Система генерирует и скачивает CSV файл с результатами.
- **Сценарий 3:** Сравнение результатов
    * *Стимул:* Администратор выбирает несколько опросов для сравнения.
    * *Ответ:* Система отображает сравнительную статистику по выбранным опросам.

#### Functional Requirements

- **RES-1**: Система должна предоставлять функции для получения результатов опросов
- **RES-2**: Система должна генерировать круговые диаграммы и гистограммы
- **RES-3**: Система должна поддерживать экспорт в форматы CSV и Markdown
- **RES-4**: Система должна вычислять базовую статистику (среднее, медиана, мода)
- **RES-5**: Система должна фильтровать результаты по демографическим данным
- **RES-6**: Система должна кэшировать часто запрашиваемые результаты

### Система тегов и категорий

#### Description and Priority

Функция позволяет организовывать опросы с помощью тегов и категорий для улучшения навигации и поиска. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление тегов к опросу
    * *Стимул:* При создании опроса администратор добавляет теги из существующих или создает новые.
    * *Ответ:* Система связывает теги с опросом и обновляет индекс поиска.
- **Сценарий 2:** Поиск опросов по тегам
    * *Стимул:* Пользователь вводит тег в поисковую строку.
    * *Ответ:* Система возвращает список опросов, связанных с данным тегом.
- **Сценарий 3:** Управление категориями
    * *Стимул:* Администратор создает новую категорию и назначает ей опросы.
    * *Ответ:* Система сохраняет категорию и связи с опросами.

#### Functional Requirements

- **TAG-1**: Система должна предоставлять функции для управления тегами
- **TAG-2**: Система должна автоматически предлагать существующие теги при вводе
- **TAG-3**: Система должна поддерживать иерархию категорий
- **TAG-4**: Система должна индексировать теги для полнотекстового поиска
- **TAG-5**: Система должна отображать облако тегов на главной странице
- **TAG-6**: Система должна ограничивать количество тегов на один опрос

### Система комментариев

#### Description and Priority

Функция позволяет пользователям оставлять комментарии к опросам и обсуждать результаты. Приоритет: Низкий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление комментария
    * *Стимул:* Пользователь прокручивает страницу опроса до раздела комментариев, вводит текст и нажимает "Отправить".
    * *Ответ:* Система сохраняет комментарий, отображает его в списке комментариев.
- **Сценарий 2:** Ответ на комментарий
    * *Стимул:* Пользователь нажимает "Ответить" под комментарием, вводит текст ответа.
    * *Ответ:* Система сохраняет ответ как дочерний комментарий, отображает в виде дерева.
- **Сценарий 3:** Модерация комментариев
    * *Стимул:* Администратор отмечает комментарий как нарушающий правила, нажимает "Удалить".
    * *Ответ:* Система помечает комментарий как удаленный, уведомляет автора.

#### Functional Requirements

- **COM-1**: Система должна предоставлять функции для работы с комментариями
- **COM-2**: Система должна поддерживать древовидную структуру комментариев
- **COM-3**: Система должна ограничивать частоту отправки комментариев для пользователя
- **COM-4**: Система должна предоставлять модерацию комментариев для администраторов
- **COM-5**: Система должна уведомлять авторов опросов о новых комментариях

### Система шаблонов опросов

#### Description and Priority

Функция позволяет создавать и использовать шаблоны опросов для быстрого создания стандартизированных опросов. Приоритет: Низкий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание шаблона
    * *Стимул:* Администратор создает опрос, отмечает его как шаблон, сохраняет.
    * *Ответ:* Система сохраняет опрос как шаблон в отдельной таблице БД.
- **Сценарий 2:** Использование шаблона
    * *Стимул:* Администратор нажимает "Создать из шаблона", выбирает шаблон из списка.
    * *Ответ:* Система создает копию шаблона как новый черновик опроса.
- **Сценарий 3:** Публикация шаблона
    * *Стимул:* Администратор помечает шаблон как публичный.
    * *Ответ:* Система делает шаблон доступным для всех пользователей системы.

#### Functional Requirements

- **TPL-1**: Система должна предоставлять функции для управления шаблонами
- **TPL-2**: Система должна поддерживать версионность шаблонов
- **TPL-3**: Система должна различать приватные и публичные шаблоны
- **TPL-4**: Система должна позволять клонировать шаблоны с модификацией
- **TPL-5**: Система должна вести статистику использования шаблонов
- **TPL-6**: Система должна поддерживать рейтинговую систему для шаблонов
