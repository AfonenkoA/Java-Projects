# Онлайн казино

## Overall Description

Система предоставляет пользователям возможность регистрации, управления виртуальным балансом, игры в различные азартные игры (слоты, рулетка, блэкджек) и просмотра истории транзакций. Административная панель позволяет управлять играми и пользователями.

### Product Functions

-   Регистрация, аутентификация и авторизация пользователей.
-   Управление пользовательским профилем и балансом.
-   Пополнение счета и вывод виртуальных средств (в учебных целях).
-   Игра в "Слот-машину" (игровой автомат).
-   Игра в "Европейскую рулетку".
-   Игра в "Блэкджек" (21 очко).
-   Просмотр истории игр и финансовых транзакций.
-   Административная панель для управления контентом и пользователями.

## System Features

### Управление балансом и транзакциями

#### Description and Priority

Позволяет пользователю пополнять свой игровой счет, запрашивать вывод средств (в учебных целях) и просматривать историю всех финансовых операций. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Пополнение счета**
    *   *Стимул:* Пользователь в разделе "Касса" выбирает сумму для пополнения (например, 500 кредитов) и нажимает "Пополнить".
    *   *Ответ:* Система атомарно увеличивает баланс пользователя в БД, создает запись в истории транзакций с типом "DEPOSIT" и отображает сообщение об успехе.
-   **Сценарий 2: Запрос на вывод средств**
    *   *Стимул:* Пользователь в разделе "Касса" вводит сумму для вывода, не превышающую текущий баланс, и нажимает "Вывести".
    *   *Ответ:* Система атомарно уменьшает баланс пользователя, создает запись в истории транзакций с типом "WITHDRAWAL" и отображает сообщение об успехе.
-   **Сценарий 3: Просмотр истории транзакций**
    *   *Стимул:* Пользователь переходит на вкладку "История транзакций".
    *   *Ответ:* Система запрашивает из БД и отображает таблицу с историей всех операций пользователя (дата, тип, сумма, остаток).

#### Functional Requirements

*   **FIN-1**: Система должна предоставлять интерфейс для пополнения виртуального баланса.
*   **FIN-2**: Система должна предоставлять интерфейс для вывода виртуальных средств.
*   **FIN-3**: Система должна гарантировать, что сумма вывода не превышает текущий баланс пользователя.
*   **FIN-4**: Все финансовые операции должны быть атомарными и сохраняться в истории транзакций.
*   **FIN-5**: Пользователь должен иметь возможность просматривать полную историю своих транзакций.

### Игровой автомат (Слоты)

#### Description and Priority

Классический игровой автомат с тремя барабанами и несколькими линиями выплат. Пользователь делает ставку и запускает вращение барабанов. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Успешный спин с выигрышем**
    *   *Стимул:* Пользователь выбирает сумму ставки (например, 10 кредитов) и нажимает кнопку "Spin".
    *   *Ответ:* Система списывает сумму ставки с баланса, генерирует случайную комбинацию символов с помощью RNG, определяет выигрыш по заранее заданным правилам, начисляет выигрыш на баланс, сохраняет результат игры в БД и анимирует отображение результата на UI.
-   **Сценарий 2: Спин без выигрыша**
    *   *Стимул:* Пользователь делает ставку и запускает спин.
    *   *Ответ:* Система списывает ставку, генерирует проигрышную комбинацию, сохраняет результат и отображает сообщение "Попробуйте еще раз!".
-   **Сценарий 3: Неудачный спин (недостаточно средств)**
    *   *Стимул:* Пользователь выбирает ставку, превышающую его баланс, и нажимает "Spin".
    *   *Ответ:* Система блокирует кнопку и отображает сообщение "Недостаточно средств на счете".

#### Functional Requirements

*   **SLOT-1**: Система должна отображать виртуальный игровой автомат с 3+ барабанами.
*   **SLOT-2**: Пользователь должен иметь возможность выбрать величину ставки перед спином.
*   **SLOT-3**: Система должна использовать криптографически стойкий RNG для определения результата вращения.
*   **SLOT-4**: Система должна автоматически вычислять выигрыш на основе выпавшей комбинации и таблицы выплат.
*   **SLOT-5**: Система должна обновлять баланс пользователя после каждого завершенного спина.
*   **SLOT-6**: Система должна сохранять историю всех игровых сессий (ставка, выигрыш, результат, дата).

### Рулетка

#### Description and Priority

Реализация европейской рулетки с одним "зеро". Пользователь может делать ставки на числа, цвета, группы чисел и др. Приоритет: Средний.

#### Stimulus/Response Sequences

-   **Сценарий 1: Ставка на цвет и выигрыш**
    *   *Стимул:* Пользователь размещает фишку (ставку) на поле "Красное" и нажимает "Крутить".
    *   *Ответ:* Система блокирует ставки, анимирует вращение рулетки, генерирует случайное число от 0 до 36, определяет, что число красное, вычисляет выигрыш (x2 от ставки), начисляет его на баланс и отображает результат.
-   **Сценарий 2: Ставка на конкретное число и проигрыш**
    *   *Стимул:* Пользователь ставит на число "17", выпадает число "5".
    *   *Ответ:* Система списывает все сделанные в этом раунде ставки, сохраняет результат и отображает выпавшее число.

#### Functional Requirements

*   **ROUL-1**: Система должна отображать игровое поле европейской рулетки (числа 0-36).
*   **ROUL-2**: Пользователь должен иметь возможность делать несколько ставок разного типа в одном раунде.
*   **ROUL-3**: Система должна использовать RNG для определения выигрышного числа.
*   **ROUL-4**: Система должна вычислять выигрыш для каждого типа ставки согласно правилам рулетки.
*   **ROUL-5**: Система должна обрабатывать ставки в рамках транзакции для обеспечения целостности данных.

### Блэкджек

#### Description and Priority

Реализация классической карточной игры Блэкджек против дилера (искусственного интеллекта). Приоритет: Средний.

#### Stimulus/Response Sequences

-   **Сценарий 1: Игрок выигрывает**
    *   *Стимул:* Пользователь делает ставку, получает две карты, нажимает "Станд". У дилера перебор.
    *   *Ответ:* Система начисляет выигрыш (x2 от ставки), сохраняет результат игры.
-   **Сценарий 2: Игрок получает Блэкджек**
    *   *Стимул:* Первые две карты игрока дают 21 очко.
    *   *Ответ:* Система немедленно начисляет выигрыш 3:2 от ставки.
-   **Сценарий 3: Дилер выигрывает**
    *   *Стимул:* У дилера больше очков, чем у игрока (и у обоих не более 21).
    *   *Ответ:* Система списывает ставку игрока.

#### Functional Requirements

*   **BJ-1**: Система должна имитировать колоду из 52 карт и механику раздачи.
*   **BJ-2**: Система должна реализовывать логику дилера (например, "дилер берет карту до 17").
*   **BJ-3**: Пользователь должен иметь возможность действий "Хит" (взять карту), "Станд" (хватит), "Дабл" (удвоить) и "Сплит" (разделить карты, опционально).
*   **BJ-4**: Система должна корректно подсчитывать очки, учитывая туз как 1 или 11.
*   **BJ-5**: Система должна определять победителя раунда и соответствующим образом изменять баланс.

### Административная панель

#### Description and Priority

Предоставляет привилегированным пользователям (администраторам) инструменты для управления системой. Приоритет: Низкий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Просмотр списка пользователей**
    *   *Стимул:* Администратор заходит в панель управления и выбирает "Пользователи".
    *   *Ответ:* Система отображает таблицу со всеми зарегистрированными пользователями, их балансом и датой регистрации.
-   **Сценарий 2: Блокировка пользователя**
    *   *Стимул:* Администратор нажимает кнопку "Заблокировать" рядом с пользователем.
    *   *Ответ:* Система помечает учетную запись как неактивную, запрещая вход.

#### Functional Requirements

*   **ADMIN-1**: Доступ к админ-панели должен быть ограничен пользователями с ролью "ADMIN".
*   **ADMIN-2**: Система должна предоставлять интерфейс для просмотра, поиска и блокировки пользователей.
*   **ADMIN-3**: Система должна предоставлять общую статистику (общее количество пользователей, общий оборот кредитов).
*   **ADMIN-4**: Система должна позволять администрировать игровые сессии (просмотр текущих игр).
