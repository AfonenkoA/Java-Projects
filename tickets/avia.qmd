# Сервис продажи авиабилетов

## Overall Description

Реализовать веб-сервис для покупки авиабилетов. Система должна предоставлять пользователям возможность поиска рейсов, бронирования билетов и управления заказами.

## Product Functions

- Регистрация и аутентификация пользователей
- Управление профилем пользователя
- Поиск и фильтрация авиарейсов
- Бронирование и покупка билетов
- Управление заказами и бронированиями
- Администрирование рейсов и пользователей
- Генерация посадочных талонов
- Управление тарифами и ценами

## System Features

### Поиск и бронирование рейсов

#### Description and Priority

Функция позволяет пользователям искать рейсы по различным критериям, просматривать доступные места и осуществлять бронирование. Включает сложные алгоритмы поиска и фильтрации. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Поиск рейсов с фильтрами
  * *Стимул:* Пользователь вводит пункт вылета, пункт назначения, даты, количество пассажиров, класс обслуживания.
  * *Ответ:* Система возвращает список доступных рейсов с ценами, временем и деталями пересадок.
- **Сценарий 2:** Бронирование рейса с выбором мест
  * *Стимул:* Пользователь выбирает рейс, вводит данные пассажиров, выбирает конкретные места в самолете.
  * *Ответ:* Система резервирует места, создает бронь с статусом "ожидание оплаты", блокирует места на 30 минут.
- **Сценарий 3:** Поиск альтернативных рейсов
  * *Стимул:* Пользователь запрашивает альтернативные варианты для выбранного маршрута.
  * *Ответ:* Система предлагает рейсы с другими авиакомпаниями или в другое время.

#### Functional Requirements

- **BOOK-1**: Система должна предоставлять функцию для поиска рейсов
- **BOOK-2**: Система должна поддерживать фильтрацию по авиакомпаниям, времени вылета/прилета, цене, количеству пересадок, классу обслуживания
- **BOOK-3**: Система должна проверять доступность мест при бронировании и блокировать их
- **BOOK-4**: Система должна автоматически освобождать забронированные места через 30 минут если оплата не произведена
- **BOOK-5**: Система должна поддерживать поиск сложных маршрутов с пересадками через 2 аэропорта
- **BOOK-6**: Система должна предоставлять функцию для получения схемы расположения мест в самолете
- **BOOK-7**: Система должна валидировать данные пассажиров (ФИО, дата рождения, номер паспорта) при бронировании

### Управление заказами

#### Description and Priority

Функция позволяет пользователям просматривать историю заказов, отменять бронирования, получать посадочные талоны и управлять своими поездками. Включает систему возвратов и изменений бронирований. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Просмотр детальной информации о заказе
  * *Стимул:* Пользователь выбирает конкретный заказ из списка.
  * *Ответ:* Система отображает полную информацию: рейсы, пассажиров, места, стоимость, статус.
- **Сценарий 2:** Отмена бронирования с возвратом средств
  * *Стимул:* Пользователь отменяет оплаченный заказ в течение разрешенного периода.
  * *Ответ:* Система инициирует процесс возврата средств через платежную систему и отправляет уведомление.
- **Сценарий 3:** Изменение бронирования
  * *Стимул:* Пользователь запрашивает изменение даты или времени рейса.
  * *Ответ:* Система проверяет возможность изменения, рассчитывает разницу в стоимости и применяет изменения.

#### Functional Requirements

- **ORDER-1**: Система должна предоставлять функцию для получения списка заказов пользователя
- **ORDER-2**: Система должна поддерживать статусы заказов: PENDING, CONFIRMED, CANCELLED, COMPLETED, REFUNDED
- **ORDER-3**: Система должна генерировать посадочные талоны в формате TXT и Markdown
- **ORDER-4**: Система должна предоставлять функцию для отмены заказов
- **ORDER-5**: Система должна рассчитывать штрафы за отмену в зависимости от тарифа и времени до вылета
- **ORDER-6**: Система должна вести историю изменений заказа

### Панель администратора

#### Description and Priority

Функция позволяет администраторам управлять рейсами, пользователями, авиакомпаниями и просматривать аналитику. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Массовое добавление рейсов
  * *Стимул:* Администратор загружает CSV файл с расписанием рейсов.
  * *Ответ:* Система парсит файл, валидирует данные и создает рейсы в системе.
- **Сценарий 2:** Настройка тарифов
  * *Стимул:* Администратор изменяет базовые тарифы для определенного маршрута.
  * *Ответ:* Система применяет изменения и пересчитывает цены для будущих рейсов.

#### Functional Requirements

- **ADMIN-1**: Система должна предоставлять web-интерфейс для администраторов для сущностей: рейсы, авиакомпании, самолеты, аэропорты
- **ADMIN-2**: Система должна генерировать отчеты по продажам с группировкой по периодам, авиакомпаниям, направлениям

### Система оплаты

#### Description and Priority

Функция интегрируется с платежными системами и обрабатывает транзакции. Приоритет: Высокий.

#### Stimulus/Response Sequences

**Сценарий 1:** Успешная оплата кредитной картой
  * *Стимул:* Пользователь вводит данные карты и подтверждает оплату.
  * *Ответ:* Система обрабатывает платеж, создает транзакцию и подтверждает заказ.

#### Functional Requirements

- **PAY-1**: Система должна обрабатывать события платежа
- **PAY-2**: Система должна вести историю транзакций 

### Управление самолетами и местами

#### Description and Priority

Функция позволяет управлять конфигурациями самолетов, схемами расположения мест и их доступностью. Включает сложные схемы салонов и правила распределения мест. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание новой конфигурации самолета
  * *Стимул:* Администратор добавляет новую модель самолета с детальной схемой салона.
  * *Ответ:* Система сохраняет конфигурацию и генерирует места в соответствии со схемой.
- **Сценарий 2:** Динамическое ценообразование мест
  * *Стимул:* Система анализирует спрос на определенные места в самолете.
  * *Ответ:* Система автоматически пересчитывает цены на премиум места (у окна, с дополнительным пространством).

#### Functional Requirements

- **AIRCRAFT-1**: Система должна хранить конфигурации самолетов в таблице с поддержкой различных схем салонов
- **AIRCRAFT-2**: Система должна отображать интерактивную схему мест при бронировании с цветовой индикацией доступности
- **AIRCRAFT-3**: Система должна поддерживать разные классы обслуживания (ECONOMY, PREMIUM_ECONOMY, BUSINESS, FIRST) с различным сервисом
- **AIRCRAFT-4**: Система должна автоматически генерировать места при создании рейса на основе конфигурации самолета
- **AIRCRAFT-5**: Система должна поддерживать динамическое ценообразование на места
- **AIRCRAFT-6**: Система должна предоставлять сведения о доступности мест в реальном времени

### Система тарифов и цен

#### Description and Priority

Функция управления тарифными планами, динамическим ценообразованием и специальными предложениями. Включает сложные правила расчета стоимости. Приоритет: Высокий.

#### Functional Requirements

- **FARE-1**: Система должна поддерживать различные тарифные планы (ECONOMY, FLEX, BUSINESS) с различными условиями
- **FARE-2**: Система должна вести историю изменения цен для аналитики и отчетности