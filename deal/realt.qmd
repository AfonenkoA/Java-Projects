# Платформа для покупки и продажи недвижимости

## Overall Description

Платформа должна обеспечивать взаимодействие между продавцами и покупателями, предоставляя удобные инструменты для поиска, публикации и управления объектами недвижимости.

## Product Functions

-   Регистрация и аутентификация пользователей с разделением ролей (Покупатель, Продавец, Администратор).
-   Управление профилем пользователя.
-   Публикация, редактирование и деактивация объявлений о недвижимости.
-   Расширенный поиск и фильтрация объектов недвижимости.
-   Управление списком избранных объектов.
-   Система бронирования просмотров объектов недвижимости.
-   Система сделок (предложение о покупке, принятие/отклонение).
-   Административная панель для модерации объявлений и пользователей.

## System Features

### Управление объявлениями о недвижимости

#### Description and Priority

Позволяет аутентифицированным пользователям с ролью "Продавец" создавать, редактировать, деактивировать и удалять объявления о недвижимости. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1:** Создание нового объявления.
    *   *Стимул:* Продавец нажимает "Добавить объект", заполняет форму (название, описание, тип недвижимости, адрес, площадь, цена, загружает до 10 фотографий) и нажимает "Опубликовать".
    *   *Ответ:* Система сохраняет данные объекта, загружает изображения в файловое хранилище, сохраняет ссылки в БД и перенаправляет продавца на страницу созданного объявления. Объявление получает статус "На модерации".
-   **Сценарий 2:** Редактирование объявления.
    *   *Стимул:* Продавец со своей страницы объявлений нажимает "Редактировать" для одного из своих активных объявлений.
    *   *Ответ:* Система предоставляет форму с предзаполненными данными. После сохранения изменений объявление снова переходит в статус "На модерации".

#### Functional Requirements

-   **PROP-1**: Только аутентифицированные продавцы могут создавать новые объявления.
-   **PROP-2**: Система должна поддерживать различные типы недвижимости (квартира, дом, участок, коммерческая).
-   **PROP-3**: Система должна валидировать обязательные поля (цена > 0, площадь > 0).
-   **PROP-4**: Система должна позволять загружать несколько изображений для одного объекта.
-   **PROP-5**: Продавец может изменять и деактивировать только свои объявления.
-   **PROP-6**: Каждое объявление должно иметь статус (Черновик, На модерации, Опубликовано, Отклонено, Снято с продажи).

### Поиск и фильтрация объектов недвижимости

#### Description and Priority

Позволяет всем пользователям (включая гостей) искать и фильтровать опубликованные объявления по различным критериям. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1:** Быстрый поиск по местоположению.
    *   *Стимул:* Гость вводит название города в поисковую строку на главной странице и нажимает "Найти".
    *   *Ответ:* Система отображает страницу с результатами поиска — список объявлений, отфильтрованных по введенному городу.
-   **Сценарий 2:** Расширенная фильтрация.
    *   *Стимул:* Пользователь на странице результатов поиска открывает панель "Расширенный поиск" и задает параметры: тип недвижимости = "Квартира", цена до 10 000 000 руб., количество комнат от 2, этаж не первый.
    *   *Ответ:* Система динамически обновляет список результатов, применяя все заданные фильтры.

#### Functional Requirements

-   **SRCH-1**: Система должна предоставлять текстовое поле для поиска по адресу (город, район, улица).
-   **SRCH-2**: Система должна предоставлять фильтры по: типу недвижимости, диапазону цены, площади, количеству комнат, этажу.
-   **SRCH-3**: В результатах поиска должны отображаться только объявления со статусом "Опубликовано".
-   **SRCH-4**: Система должна поддерживать пагинацию результатов поиска.

### Управление избранными объектами

#### Description and Priority

Позволяет аутентифицированным пользователям (покупателям) добавлять объекты в "Избранное" для быстрого доступа к ним в будущем. Приоритет: Средний.

#### Stimulus/Response Sequences

**Сценарий:** Добавление объекта в избранное.
-   *Стимул:* Аутентифицированный пользователь на странице просмотра объявления нажимает на иконку "Сердечко".
-   *Ответ:* Система добавляет связь между пользователем и объектом в БД. Иконка меняет цвет/состояние на "активное".

#### Functional Requirements

-   **FAV-1**: Аутентифицированный пользователь должен иметь возможность добавить любое опубликованное объявление в свой список избранного.
-   **FAV-2**: Пользователь должен иметь возможность просмотреть полный список своих избранных объектов.
-   **FAV-3**: Пользователь должен иметь возможность удалить объект из избранного.

### Система бронирования просмотров

#### Description and Priority

Позволяет покупателям бронировать удобное время для просмотра объекта недвижимости, а продавцам — управлять своим календарем просмотров. Приоритет: Средний.

#### Stimulus/Response Sequences

**Сценарий:** Покупатель бронирует просмотр.
-   *Стимул:* Покупатель на странице объявления нажимает "Забронировать просмотр", выбирает доступную дату и время из календаря.
-   *Ответ:* Система создает запрос на просмотр со статусом "Ожидает подтверждения". Продавец и покупатель получают внутрисистемные уведомления.

#### Functional Requirements

-   **VIEW-1**: Продавец должен иметь возможность настроить расписание доступных для просмотра слотов.
-   **VIEW-2**: Покупатель должен видеть только свободные слоты для бронирования.
-   **VIEW-3**: Система должна позволять продавцу подтверждать или отклонять запросы на просмотр.
-   **VIEW-4**: После подтверждения просмотра система должна отображать контактные данные продавца покупателю и наоборот.

### Система сделок

#### Description and Priority

Позволяет покупателю отправить официальное предложение о покупке, а продавцу — управлять этими предложениями (принимать или отклонять). Приоритет: Средний.

#### Stimulus/Response Sequences

**Сценарий:** Покупатель делает предложение.
-   *Стимул:* Покупатель на странице объявления нажимает "Предложить цену", вводит свою цену (может быть ниже или выше указанной) и отправляет предложение.
-   *Ответ:* Система создает запись о сделке со статусом "Предложение отправлено". Продавец получает уведомление.

#### Functional Requirements

-   **DEAL-1**: Покупатель может отправить только одно активное предложение на один объект недвижимости.
-   **DEAL-2**: Продавец видит список всех предложений по своим объектам.
-   **DEAL-3**: Продавец может принять только одно предложение для одного объекта. Принятие предложения автоматически меняет статус объявления на "Продан" и отклоняет все остальные предложения по этому объекту.
-   **DEAL-4**: Сделка должна хранить историю изменения статуса.

### Административная панель и модерация

#### Description and Priority

Предоставляет администраторам инструменты для управления контентом и пользователями. Приоритет: Высокий.

#### Stimulus/Response Sequences

**Сценарий:** Модерация нового объявления.
-   *Стимул:* Администратор заходит в панель управления и видит список объявлений со статусом "На модерации".
-   *Ответ:* Администратор просматривает объявление, проверяет его на соответствие правилам и нажимает кнопку "Одобрить" или "Отклонить". Система меняет статус объявления и уведомляет продавца.

#### Functional Requirements

-   **ADMIN-1**: Только пользователи с ролью "ADMIN" имеют доступ к панели управления.
-   **ADMIN-2**: Администратор должен иметь возможность просматривать, одобрять и отклонять объявления.
-   **ADMIN-3**: Администратор должен иметь возможность блокировать/разблокировать пользователей.
-   **ADMIN-4**: Администратор должен иметь возможность снимать с публикации любое объявление с указанием причины.