# Магазин стройматериалов

# Строительный интернет-магазин "BuildMaster"

## Overall Description

Реализовать веб-приложение строительного интернет-магазина с полным циклом работы с клиентами, каталогом товаров и системой заказов.

## Product Functions

- Регистрация и аутентификация пользователей
- Управление профилем пользователя и ролями
- Просмотр и поиск товаров в каталоге
- Управление корзиной покупок
- Оформление и отслеживание заказов
- Управление товарами и категориями (для администраторов)
- Система отзывов и рейтингов товаров
- Управление складскими остатками
- Система скидок и промокодов

## System Features

### Управление аккаунтом и ролями

#### Description and Priority

Функция позволяет пользователям регистрироваться, аутентифицироваться и управлять ролями (покупатель, менеджер, администратор). Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Регистрация покупателя
  - *Стимул:* Гость заполняет форму регистрации с email, паролем, ФИО и контактными данными.
  - *Ответ:* Система создает учетную запись с ролью "покупатель", отправляет email подтверждение.
- **Сценарий 2:** Вход в систему
  - *Стимул:* Пользователь вводит email и пароль.
  - *Ответ:* Система аутентифицирует пользователя, создает сессию с учетом ролевых разрешений.
- **Сценарий 3:** Назначение роли администратором
  - *Стимул:* Администратор назначает пользователю роль "менеджер".
  - *Ответ:* Система обновляет права доступа пользователя.

#### Functional Requirements

- **AUTH-1**: Система должна предоставлять REST endpoint для регистрации новых пользователей
- **AUTH-2**: Пароли должны храниться в хэшированном виде с использованием bcrypt
- **AUTH-3**: Система должна поддерживать роли: покупатель, менеджер, администратор
- **AUTH-4**: JWT токен должен содержать информацию о роли пользователя
- **AUTH-5**: Доступ к административным функциям должен быть ограничен по ролям

### Управление каталогом товаров

#### Description and Priority

Функция позволяет просматривать, искать и фильтровать товары строительной тематики. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Поиск товаров
  - *Стимул:* Пользователь вводит поисковый запрос "цемент М500" и применяет фильтры.
  - *Ответ:* Система возвращает список товаров, соответствующих критериям, с пагинацией.
- **Сценарий 2:** Просмотр категорий
  - *Стимул:* Пользователь выбирает категорию "Электроинструменты".
  - *Ответ:* Система отображает товары категории с возможностью сортировки по цене/рейтингу.
- **Сценарий 3:** Добавление товара администратором
  - *Стимул:* Администратор заполняет форму добавления товара с фото, описанием, характеристиками.
  - *Ответ:* Система создает новую позицию в каталоге, резервирует место на складе.

#### Functional Requirements

- **CAT-1**: Система должна предоставлять REST API для поиска товаров с фильтрацией
- **CAT-2**: Поддержка древовидной структуры категорий товаров
- **CAT-3**: Возможность сортировки товаров по цене, рейтингу, дате добавления
- **CAT-4**: Поиск должен учитывать название, описание и характеристики товаров
- **CAT-5**: Администраторы должны иметь возможность управлять видимостью товаров

### Управление корзиной покупок

#### Description and Priority

Функция позволяет пользователям добавлять товары в корзину, изменять количество и удалять позиции. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление товара в корзину
  - *Стимул:* Пользователь нажимает "В корзину" на странице товара.
  - *Ответ:* Система добавляет товар в корзину пользователя, обновляет счетчик.
- **Сценарий 2:** Изменение количества товара
  - *Стимул:* Пользователь изменяет количество товара в корзине.
  - *Ответ:* Система пересчитывает общую стоимость, проверяет доступность на складе.
- **Сценарий 3:** Применение промокода
  - *Стимул:* Пользователь вводит промокод в корзине.
  - *Ответ:* Система проверяет валидность промокода и применяет скидку.

#### Functional Requirements

- **CART-1**: Корзина должна сохраняться между сессиями для аутентифицированных пользователей
- **CART-2**: Система должна проверять доступность товара на складе при добавлении в корзину
- **CART-3**: Реализация корзины должна использовать Jakarta EE Session Beans
- **CART-4**: Автоматическое удаление недоступных товаров из корзины
- **CART-5**: Расчет общей стоимости с учетом скидок и промокодов

### Оформление и обработка заказов

#### Description and Priority

Функция позволяет оформлять заказы, выбирать способы доставки и оплаты, отслеживать статус заказа. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание заказа
  - *Стимул:* Пользователь подтверждает оформление заказа из корзины.
  - *Ответ:* Система создает заказ, резервирует товары, отправляет уведомление.
- **Сценарий 2:** Изменение статуса заказа
  - *Стимул:* Менеджер изменяет статус заказа на "Доставляется".
  - *Ответ:* Система обновляет статус, уведомляет покупателя.
- **Сценарий 3:** Отмена заказа
  - *Стимул:* Пользователь отменяет заказ в личном кабинете.
  - *Ответ:* Система отменяет резерв товаров, обновляет статус заказа.

#### Functional Requirements
- **ORDER-1**: Система должна поддерживать статусы: новый, подтвержденный, собран, доставляется, выполнен, отменен
- **ORDER-2**: Интеграция с внешними системами расчета стоимости доставки
- **ORDER-3**: Поддержка различных способов оплаты (карта, наличные, онлайн)
- **ORDER-4**: История заказов в личном кабинете пользователя
- **ORDER-5**: Автоматическая отмена неоплаченных заказов через 24 часа

### Система отзывов и рейтингов

#### Description and Priority

Функция позволяет оставлять отзывы и оценки к purchased товарам. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление отзыва
  - *Стимул:* Пользователь оставляет отзыв к доставленному товару.
  - *Ответ:* Система проверяет право на отзыв, публикует отзыв после модерации.
- **Сценарий 2:** Модерация отзывов
  - *Стимул:* Менеджер проверяет и одобряет отзыв.
  - *Ответ:* Система публикует отзыв, пересчитывает рейтинг товара.

#### Functional Requirements

- **REV-1**: Возможность оставлять отзывы только на purchased товары
- **REV-2**: Модерация отзывов перед публикацией
- **REV-3**: Расчет среднего рейтинга товара на основе оценок
- **REV-4**: Возможность прикрепления фото к отзывам
- **REV-5**: Система жалоб на некорректные отзывы

### Управление складом

#### Description and Priority

Функция позволяет отслеживать остатки товаров, управлять поставками и резервами. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Обновление остатков
  - *Стимул:* Менеджер добавляет новую поставку товара.
  - *Ответ:* Система обновляет количество на складе, снимает товар с "нет в наличии".
- **Сценарий 2:** Резервирование товара
  - *Стимул:* Пользователь оформляет заказ.
  - *Ответ:* Система резервирует товар, уменьшая доступное количество.

#### Functional Requirements

- **STOCK-1**: Реальное время отображения остатков товаров
- **STOCK-2**: Автоматическое уведомление о низких остатках
- **STOCK-3**: История движений товаров на складе
- **STOCK-4**: Поддержка нескольких складов
- **STOCK-5**: Интеграция с системой заказов для автоматического резервирования

### Система скидок и промокодов

#### Description and Priority

Функция позволяет создавать и управлять системой скидок, акциями и промокодами. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание промокода
  - *Стимул:* Администратор создает промокод на скидку 10%.
  - *Ответ:* Система генерирует уникальный код, устанавливает условия применения.
- **Сценарий 2:** Применение скидки
  - *Стимул:* Пользователь применяет промокод в корзине.
  - *Ответ:* Система проверяет условия и применяет скидку к заказу.

#### Functional Requirements

- **DISC-1**: Поддержка различных типов скидок (процентные, фиксированные)
- **DISC-2**: Ограничение скидок по времени, количеству использований
- **DISC-3**: Совмещение нескольких акций
- **DISC-4**: Автоматические скидки для постоянных клиентов
- **DISC-5**: Отчеты по эффективности промо-акций
