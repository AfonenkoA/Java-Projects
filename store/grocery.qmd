# Продуктовый магазин

## 2. Общее описание

Система является независимым веб-приложением, предоставляющим функционал интернет-магазина с административной панелью управления.

### 2.2 Функции продукта
- Управление пользователями и аутентификация
- Каталог товаров с категориями и фильтрацией
- Корзина покупок и оформление заказов
- Система оплаты и управление заказами
- Личный кабинет пользователя
- Административная панель управления
- Поиск и фильтрация товаров
- Система отзывов и рейтингов

## 3. Системные особенности

### 3.2 Управление каталогом товаров

#### Description and Priority

Функция управления категориями и товарами, включая добавление, редактирование и удаление. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление нового товара
    - *Стимул:* Администратор заполняет форму товара (название, описание, цена, категория, изображения).
    - *Ответ:* Система валидирует данные, сохраняет товар в БД и отображает его в каталоге.
- **Сценарий 2:** Фильтрация товаров
    - *Стимул:* Пользователь выбирает категорию и устанавливает диапазон цен.
    - *Ответ:* Система отображает товары, соответствующие критериям фильтрации.

#### Functional Requirements

- **CAT-1**: Система должна позволять администраторам создавать, редактировать и удалять категории товаров.
- **CAT-2**: Система должна позволять администраторам добавлять товары с указанием названия, описания, цены, количества на складе, категории.
- **CAT-3**: Система должна поддерживать загрузку нескольких изображений для каждого товара.
- **CAT-4**: Система должна предоставлять интерфейс фильтрации товаров по категориям, цене, бренду.
- **CAT-5**: Система должна поддерживать пагинацию товаров в каталоге.

### 3.3 Корзина покупок

#### Description and Priority

Функция управления корзиной покупок: добавление, изменение количества, удаление товаров. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Добавление товара в корзину
    - *Стимул:* Пользователь нажимает "Добавить в корзину" на странице товара.
    - *Ответ:* Система добавляет товар в корзину пользователя и обновляет счетчик корзины.
- **Сценарий 2:** Изменение количества товара
    - *Стимул:* Пользователь изменяет количество товара в корзине.
    - *Ответ:* Система пересчитывает общую стоимость и сохраняет изменения.

#### Functional Requirements

- **CART-1**: Система должна позволять аутентифицированным пользователям добавлять товары в корзину.
- **CART-2**: Система должна сохранять содержимое корзины между сессиями.
- **CART-3**: Система должна проверять доступность товара на складе при добавлении в корзину.
- **CART-4**: Система должна автоматически пересчитывать общую стоимость при изменении состава корзины.
- **CART-5**: Система должна ограничивать максимальное количество каждого товара в корзине based на остатках.

### 3.4 Оформление заказа

#### Description and Priority

Функция оформления и обработки заказов. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Создание заказа
    - *Стимул:* Пользователь нажимает "Оформить заказ" из корзины, выбирает адрес доставки и способ оплаты.
    - *Ответ:* Система создает заказ, резервирует товары на складе, перенаправляет на страницу оплаты.
- **Сценарий 2:** Отмена заказа
    - *Стимул:* Пользователь отменяет неоплаченный заказ.
    - *Ответ:* Система отменяет заказ и снимает резерв с товаров.

#### Functional Requirements

- **ORDER-1**: Система должна позволять пользователям создавать заказы из содержимого корзины.
- **ORDER-2**: Система должна запрашивать адрес доставки и контактные данные при оформлении.
- **ORDER-3**: Система должна резервировать товары на складе при создании заказа.
- **ORDER-4**: Система должна поддерживать статусы заказов: "Ожидает оплаты", "Оплачен", "В обработке", "Отправлен", "Доставлен", "Отменен".
- **ORDER-5**: Система должна уведомлять пользователей об изменении статуса заказа.

### 3.5 Система оплаты

#### Description and Priority

Функция обработки платежей через интеграцию с платежными системами. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий 1:** Оплата заказа
    - *Стимул:* Пользователь выбирает способ оплаты и перенаправляется на страницу платежного шлюза.
    - *Ответ:* После успешной оплаты система обновляет статус заказа и отправляет подтверждение.
- **Сценарий 2:** Обработка callback от платежной системы
    - *Стимул:* Платежная система отправляет уведомление о статусе платежа.
    - *Ответ:* Система проверяет подпись и обновляет статус заказа в БД.

#### Functional Requirements

- **PAY-1**: Система должна интегрироваться как минимум с одной платежной системой (например, Stripe, PayPal).
- **PAY-2**: Система должна безопасно обрабатывать callback от платежных систем.
- **PAY-3**: Система должна поддерживать обработку неудачных платежей с возможностью повторной оплаты.
- **PAY-4**: Система должна вести логи всех транзакций.

### 3.6 Личный кабинет

#### Description and Priority

Функция предоставления пользователям доступа к истории заказов и управления профилем. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий:** Просмотр истории заказов
    - *Стимул:* Пользователь переходит в раздел "Мои заказы".
    - *Ответ:* Система отображает список заказов с детальной информацией по каждому.

#### Functional Requirements

- **ACCOUNT-1**: Пользователь должен иметь возможность просматривать историю своих заказов.
- **ACCOUNT-2**: Пользователь должен иметь возможность управлять адресами доставки.
- **ACCOUNT-3**: Пользователь должен иметь возможность редактировать личные данные.
- **ACCOUNT-4**: Система должна отображать текущий статус для каждого заказа в истории.

### 3.7 Административная панель

#### Description and Priority

Функция управления магазином для администраторов. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий:** Управление заказами
    - *Стимул:* Администратор изменяет статус заказа на "Отправлен" и вводит номер отслеживания.
    - *Ответ:* Система обновляет статус заказа и уведомляет пользователя.

#### Functional Requirements

- **ADMIN-1**: Система должна предоставлять интерфейс для управления товарами и категориями.
- **ADMIN-2**: Система должна предоставлять интерфейс для просмотра и управления заказами.
- **ADMIN-3**: Система должна предоставлять отчеты по продажам за выбранный период.
- **ADMIN-4**: Система должна разграничивать права доступа для разных ролей пользователей.

### 3.8 Поиск и фильтрация

#### Description and Priority

Функция поиска товаров по различным критериям. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий:** Поиск товаров
    - *Стимул:* Пользователь вводит поисковый запрос в строку поиска.
    - *Ответ:* Система отображает товары, соответствующие запросу, с возможностью дополнительной фильтрации.

#### Functional Requirements

- **SEARCH-1**: Система должна предоставлять полнотекстовый поиск по названиям и описаниям товаров.
- **SEARCH-2**: Система должна поддерживать фильтрацию результатов поиска по категориям, цене, рейтингу.
- **SEARCH-3**: Система должна кэшировать популярные поисковые запросы.

### 3.9 Система отзывов и рейтингов

#### Description and Priority

Функция allowing пользователям оставлять отзывы и оценки для товаров. Приоритет: Средний.

#### Stimulus/Response Sequences

- **Сценарий:** Добавление отзыва
    - *Стимул:* Пользователь, купивший товар, оставляет отзыв и оценку.
    - *Ответ:* Система сохраняет отзыв, пересчитывает средний рейтинг товара и публикует отзыв после модерации.

#### Functional Requirements

- **REVIEW-1**: Система должна позволять оставлять отзывы только пользователям, купившим товар.
- **REVIEW-2**: Система должна рассчитывать средний рейтинг для каждого товара.
- **REVIEW-3**: Система должна предусматривать модерацию отзывов администратором.
- **REVIEW-4**: Система должна отображать отзывы на странице товара с пагинацией.

### 3.10 Управление складом

#### Description and Priority

Функция отслеживания остатков товаров и управления инвентарем. Приоритет: Высокий.

#### Stimulus/Response Sequences

- **Сценарий:** Обновление остатков
    - *Стимул:* Администратор добавляет новые поступления товара на склад.
    - *Ответ:* Система обновляет количество доступного товара и снимает резерв с заказов, ожидающих restock.

#### Functional Requirements

- **INV-1**: Система должна отслеживать текущие остатки товаров на складе.
- **INV-2**: Система должна автоматически обновлять остатки при оформлении и отмене заказов.
- **INV-3**: Система должна уведомлять администратора при низком уровне остатков.
- **INV-4**: Система должна поддерживать историю движений товаров на складе.
