# Сервис аренды средств персональной мобильности

## Overall Description

Система представляет собой веб-приложение, которое позволяет пользователям находить, бронировать и арендовать СПМ. Система управляет учетными записями пользователей, парком транспортных средств, обработкой платежей и учетом аренды.

## Product Functions

*   Управление аккаунтом пользователя
*   Управление каталогом и состоянием СПМ
*   Процесс аренды СПМ
*   Управление платежами и расчетами
*   Панель администратора для управления системой

## System Features

### Управление каталогом и состоянием СПМ

#### Description and Priority

Функция позволяет системе управлять парком СПМ: добавлять, удалять, изменять данные о транспорте, а также отслеживать их текущее местоположение и статус (доступен, арендован, на обслуживании). Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Поиск доступных СПМ**
    *   *Стимул:* Пользователь открывает карту на главной странице.
    *   *Ответ:* Система запрашивает из БД все СПМ со статусом "доступен" и возвращает их координаты и метаданные для отображения на карте.
-   **Сценарий 2: Администратор добавляет новое СПМ**
    *   *Стимул:* Администратор через панель управления вводит данные нового СПМ (тип, модель, координаты размещения).
    *   *Ответ:* Система создает новую запись в БД и присваивает СПМ уникальный идентификатор.

#### Functional Requirements

*   **VEH-1**: Система должна предоставлять возможность для получения списка всех доступных СПМ в заданном радиусе от пользователя.
*   **VEH-2**: Система должна хранить для каждого СПМ следующие данные: уникальный ID, тип, модель, текущие координаты (широта, долгота), заряд батареи, статус (доступен, арендован, неисправен).
*   **VEH-3**: Система должна предоставлять администратору возможность для операций управления СПМ.
*   **VEH-4**: Система должна автоматически обновлять статус СПМ при начале и окончании аренды.

### Процесс аренды СПМ

#### Description and Priority

Функция описывает полный жизненный цикл аренды: от бронирования до завершения поездки и блокировки средств. Приоритет: Высокий.

#### Stimulus/Response Sequences

-   **Сценарий 1: Начало аренды**
    *   *Стимул:* Пользователь на карте выбирает доступное СПМ и нажимает кнопку "Арендовать".
    *   *Ответ:* Система проверяет, не имеет ли пользователь активных аренд, блокирует небольшую сумму на его счете для проверки платежеспособности, изменяет статус СПМ на "арендован", создает запись о начале поездки в БД и предоставляет пользователю код для разблокировки транспорта.
-   **Сценарий 2: Завершение аренды**
    *   *Стимул:* Пользователь ставит СПМ в разрешенное место и нажимает "Завершить поездку" в приложении.
    *   *Ответ:* Система фиксирует конечные координаты, вычисляет длительность и стоимость поездки, списывает средства с привязанной карты пользователя, разблокирует сумму-холд, изменяет статус СПМ на "доступен" и сохраняет завершенную поездку в историю.

#### Functional Requirements

*   **RENT-1**: Система должна предоставлять функциональность для начала аренды, который проверяет доступность выбранного СПМ.
*   **RENT-2**: Система должна предотвращать начало новой аренды, если у пользователя есть активная поездка.
*   **RENT-3**: Система должна вычислять стоимость поездки на основе тарифов (время, расстояние) и сохранять итоговую сумму.
*   **RENT-4**: Система должна предоставлять функциональность для завершения аренды, который инициирует процесс расчета и списания средств.

### Панель администратора

#### Description and Priority

Функция предоставляет администраторам интерфейс для полного управления системой: пользователями, СПМ, тарифами и просмотра отчетности. Приоритет: Средний.

#### Stimulus/Response Sequences

-   **Сценарий 1: Просмотр общей статистики**
    *   *Стимул:* Администратор заходит в панель управления на главный экран.
    *   *Ответ:* Система отображает дашборд с ключевыми метриками: количество активных поездок, общий доход за сегодня, количество доступных/неисправных СПМ.
-   **Сценарий 2: Изменение тарифов**
    *   *Стимул:* Администратор переходит в раздел "Тарифы" и изменяет стоимость за минуту.
    *   *Ответ:* Система применяет новые тарифы для всех последующих поездок.

#### Functional Requirements

*   **ADM-1**: Система должна предоставлять веб-интерфейс, доступных только пользователям с ролью "Администратор".
*   **ADM-2**: Система должна позволять администратору осуществлять поиск, блокировку и разблокировку пользователей.
*   **ADM-3**: Система должна позволять администратору управлять тарифами (создавать, читать, обновлять).
*   **ADM-4**: Система должна генерировать отчеты по доходам и количеству поездок за выбранный период.
